% crochet

open crochet.novella;

command main-html: Root do
  let Dialogue-layer =
    #nvl-layer name: "dialogue"
    | transform: (#nvl-transform with: [
        #nvl-position x: (#nvl-unit pixels: 0) y: (#nvl-unit pixels: 340),
        #nvl-dimension width: (#nvl-unit pixels: 400) height: (#nvl-unit pixels: 380),
        #nvl-padding zero | all: (#nvl-unit pixels: 20),
      ]);
  let Menu-layer =
    #nvl-layer name: "menu"
      | transform: (#nvl-transform with: [
          #nvl-position x: (#nvl-unit pixels: 0) y: (#nvl-unit pixels: 600),
          #nvl-dimension width: (#nvl-unit pixels: 400) height: (#nvl-unit pixels: 120),
        ]);
  let Background-layer =
    #nvl-layer name: "background"
      | transform: (#nvl-transform with: [
          #nvl-position x: (#nvl-unit pixels: 0) y: (#nvl-unit pixels: 20),
          #nvl-dimension width: (#nvl-unit pixels: 400) height: (#nvl-unit pixels: 320),
        ]);
  let Layers = #nvl-layer-group
                  layers: [Background-layer, Dialogue-layer, Menu-layer]
                  dialogue: Dialogue-layer
                  menu: Menu-layer;
  let Renderer = novella web-renderer: Root
                  | layers: Layers
                  | width: 400 height: 720;
  handle
    novella say: "One line of text.";
    novella say: "Two lines of text.";
    novella clear: Dialogue-layer;
    novella say: "One line again";
    novella say: "More lines of text.";
    novella say: "More!!!!";
    let Selection = novella menu: (#nvl-menu items: [
      #nvl-menu-leaf label: "Go ..." value: "went",
      #nvl-menu-leaf label: "Search ..." value: "searched",
      #nvl-menu-leaf label: "Take ..." value: "taken",
    ]);
    novella say: Selection;
  with
    use novella-game renderer: Renderer;
  end
end